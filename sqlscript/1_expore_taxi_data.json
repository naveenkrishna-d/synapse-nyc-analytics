{
	"name": "1_expore_taxi_data",
	"properties": {
		"folder": {
			"name": "DEMOS"
		},
		"content": {
			"query": "-- SELECT * From sys.dm_external_data_processed;\n-- SELECT * from sys.configurations where name like 'Data Pro%';\n\n-- sp_set_data_processed_limit\n-- @type=N'monthly',\n-- @limit_tb=4;\n\n-- SELECT TOP 100 * \n-- FROM \n--     OPENROWSET(\n--         BULK 'abfss://nyc-taxi-data@marlabsnycanalyticsdl.dfs.core.windows.net/taxi_zone.csv',\n--         FORMAT='CSV',\n--         PARSER_VERSION='2.0',\n--         HEADER_ROW = TRUE,\n--         FIELDTERMINATOR=',',\n--         ROWTERMINATOR='\\n'\n-- )AS [result]\n\n\n-- EXEC sp_describe_first_result_set N'SELECT TOP 100 * FROM\n--     OPENROWSET(\n--         BULK ''abfss://nyc-taxi-data@marlabsnycanalyticsdl.dfs.core.windows.net/taxi_zone.csv'',\n--         FORMAT = ''CSV'',\n--         PARSER_VERSION = ''2.0'',\n--         HEADER_ROW = TRUE\n--     ) WITH (\n--     LocationID SMALLINT,\n--     Borough VARCHAR(15),\n--     Zone VARCHAR(50),\n--     service_zone VARCHAR(15)\n-- ) AS [result]'\n\n-- SELECT \n-- MAX(LEN(LocationID)) as len_LocationID,\n-- MAX(LEN(Borough)) as len_Borough,\n-- MAX(LEN(Zone)) as len_Zone,\n-- MAX(LEN(service_zone)) as len_service_zone\n-- FROM \n--     OPENROWSET(\n--         BULK 'abfss://nyc-taxi-data@marlabsnycanalyticsdl.dfs.core.windows.net/taxi_zone.csv',\n--         FORMAT='CSV',\n--         PARSER_VERSION='2.0',\n--         HEADER_ROW = TRUE,\n--         FIELDTERMINATOR=',',\n--         ROWTERMINATOR='\\n'\n-- )AS [result]\n\n-- SELECT TOP 100 *\n-- FROM \n--     OPENROWSET(\n--         BULK 'abfss://nyc-taxi-data@marlabsnycanalyticsdl.dfs.core.windows.net/taxi_zone.csv',\n--         FORMAT='CSV',\n--         PARSER_VERSION='2.0',\n--         HEADER_ROW = TRUE\n-- ) WITH (\n--     LocationID SMALLINT,\n--     Borough NVARCHAR(15),\n--     Zone NVARCHAR(50),\n--     service_zone VARCHAR(15)\n-- )\n-- AS [result]\n\n-- Explicitly change the collation\n\n-- SELECT name,collation_name from sys.databases;\n\n-- SELECT TOP 100 *\n-- FROM \n--     OPENROWSET(\n--         BULK 'abfss://nyc-taxi-data@marlabsnycanalyticsdl.dfs.core.windows.net/taxi_zone.csv',\n--         FORMAT='CSV',\n--         PARSER_VERSION='2.0',\n--         HEADER_ROW = TRUE\n-- ) WITH (\n--     LocationID SMALLINT ,\n--     Borough NVARCHAR(15),\n--     Zone NVARCHAR(50),\n--     service_zone VARCHAR(15) COLLATE Latin1_General_100_CI_AI_SC_UTF8\n-- )\n-- AS [result]\n\n\n-- CREATE DATABASE nyc_taxi_discovery;\n-- USE nyc_taxi_discovery;\n\n-- SELECT name,collation_name from sys.databases;\n\n-- ALTER DATABASE nyc_taxi_discovery COLLATE Latin1_General_100_CI_AI_SC_UTF8;\n\n--Query Subset of data\n\n\n\nSELECT TOP 100 *\nFROM \n    OPENROWSET(\n        BULK 'abfss://nyc-taxi-data@marlabsnycanalyticsdl.dfs.core.windows.net/taxi_zone_without_header.csv',\n        FORMAT='CSV',\n        PARSER_VERSION='2.0'\n) WITH ( --numbers here are column ordinal\n    Borough NVARCHAR(15) 2,\n    service_zone VARCHAR(15) 4\n)\nAS [result]\n\n--fix column names\n\nSELECT TOP 100 *\nFROM \n    OPENROWSET(\n        BULK 'abfss://nyc-taxi-data@marlabsnycanalyticsdl.dfs.core.windows.net/taxi_zone.csv',\n        FORMAT='CSV',\n        PARSER_VERSION='2.0',\n        FIRSTROW=2\n        --HEADER_ROW = TRUE\n) WITH (\n    location_id SMALLINT 1 ,\n    borough NVARCHAR(15) 2,\n    zone NVARCHAR(50) 3,\n    service_zone VARCHAR(15) 4\n)\nAS [result]\n\n-- create external data source\n\nCREATE EXTERNAL DATA SOURCE nyc_taxi_data\nWITH(\n    LOCATION = 'abfss://nyc-taxi-data@marlabsnycanalyticsdl.dfs.core.windows.net/'\n)\n\nCREATE EXTERNAL DATA SOURCE nyc_taxi_data_raw\nWITH(\n    LOCATION = 'abfss://nyc-taxi-data@marlabsnycanalyticsdl.dfs.core.windows.net/raw'\n)\n\n\n--DROP EXTERNAL DATA SOURCE nyc_taxi_data1\n\nSELECT TOP 100 *\nFROM \n    OPENROWSET(\n        BULK 'taxi_zone.csv',\n        DATA_SOURCE= 'nyc_taxi_data',\n        FORMAT='CSV',\n        PARSER_VERSION='2.0',\n        FIRSTROW=2\n        --HEADER_ROW = TRUE\n) WITH (\n    location_id SMALLINT 1 ,\n    borough NVARCHAR(15) 2,\n    zone NVARCHAR(50) 3,\n    service_zone VARCHAR(15) 4\n)\nAS [result]\n\nSELECT name,location from sys.external_data_sources;\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "nyc_taxi_discovery",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}